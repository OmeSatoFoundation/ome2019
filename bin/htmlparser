#!/usr/bin/env python2
#encoding:utf-8
import sys
import ast
from bs4 import BeautifulSoup
def htmltag(html, tag):
    return htmltagattr(html, tag, {})
def htmltagattr(html, tag, attrs):
    soup = BeautifulSoup(html, 'html.parser')
    result = soup.find_all(tag, attrs=attrs)
    data = []
    for i in result:
        data.append(i)
        print(i)
    return data
def htmlsrc(html, tag):
    soup = BeautifulSoup(html, 'html.parser')
    result = soup.find_all(tag)
    data = []
    for i in result:
        data.append(i.get('src'))
        print(i.get('src'))
    return data
def htmltext(html, tag):
    soup = BeautifulSoup(html, 'html.parser')
    result = soup.find_all(tag)
    data = []
    for i in result:
        for j in i:
            data.append(j)
            print(j)
    return data
def htmllink(html, tag):
    soup = BeautifulSoup(html, 'html.parser')
    result = soup.find_all(tag)
    data = []
    for i in result:
        data.append(i.get('href'))
        print(i.get('href'))
    return data
def htmltable():
    pass
def main():
    f = open(sys.argv[2])
    s = "".join(f.readlines())
    if(sys.argv[1] == '1'):
        htmltag(s, sys.argv[3])
    elif(sys.argv[1] == '2'):
        if(len(sys.argv[4]) == 0):
            attrs = {}
        else:
            attrs = '{"' + sys.argv[4].split(':')[0] + '":"' + ' '.join(sys.argv[4].split(':')[1].split(',')) + '"}'
            attrs = ast.literal_eval(attrs) 
        htmltagattr(s, sys.argv[3], attrs)
    elif(sys.argv[1] == '3'):
        htmlsrc(s, sys.argv[3])
    elif(sys.argv[1] == '4'):
        htmltext(s, sys.argv[3])
    elif(sys.argv[1] == '5'):
        htmllink(s, sys.argv[3])
if __name__ == '__main__':
    main()

